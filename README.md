# Flowturi Real-Time Sandbox

A self-contained Flink + WebSocket bridge + Flowturi Studio demo for real-time Sankey diagram streaming.

---

## 📦 Features

* Apache Flink (optional future) streaming synthetic data generator
* Node.js WebSocket bridge (serves data to Flowturi Studio)
* Real-time data simulated by synthetic generator script
* Docker Compose setup for local testing
* Portable, no host installation required

---

## 🧱 Project Structure

```
flowturi-realtime-sandbox/
├── docker-compose.yml
├── flink/                 # (Optional future: Flink job loader)
├── bridge/
│   ├── Dockerfile
│   ├── package.json
│   ├── bridge.js
│   ├── synthetic.js
│   └── stream.json
└── README.md
```

---

## 🚀 Quickstart

1. Clone this repo:

```bash
git clone https://github.com/your-user/flowturi-realtime-sandbox.git
cd flowturi-realtime-sandbox
```

2. Start the services:

```bash
docker-compose up
```

3. Open the Flink dashboard (optional):
   ➡️ [http://localhost:8081](http://localhost:8081)

4. Open Flowturi Studio, enter Real-Time mode, and connect to:

```
ws://localhost:8082
```

You should begin seeing a live-updating Sankey diagram driven by synthetic data.

---

## 🔧 WebSocket Bridge with Generator

### `bridge.js`

Watches `stream.json` for changes and broadcasts updated Sankey data to WebSocket clients.

### `synthetic.js`

Writes realistic but random flow data to `stream.json` every second.

---

## 🧪 Testing Without Flink

No need to install Flink yet — synthetic data is generated by `synthetic.js`.

Example payload:

```json
{
  "timestamp": 1715558023737,
  "tick": 4,
  "nodes": [ ... ],
  "links": [ ... ]
}
```

---

## 📄 `docker-compose.yml`

```yaml
version: "3"
services:
  websocket-bridge:
    build: ./bridge
    ports:
      - "8082:8082"
```

---

## 🐳 `bridge/Dockerfile`

```Dockerfile
FROM node:18
WORKDIR /app
COPY package.json ./
RUN npm install
RUN npm install npm-run-all
COPY bridge.js stream.json synthetic.js ./
CMD ["npm", "run", "start"]
```

---

## 🧰 `package.json`

```json
{
  "name": "flowturi-bridge",
  "version": "1.0.0",
  "main": "bridge.js",
  "dependencies": {
    "ws": "^8.0.0"
  },
  "devDependencies": {
    "npm-run-all": "^4.1.5"
  },
  "scripts": {
    "generate": "node synthetic.js",
    "bridge": "node bridge.js",
    "start": "run-p generate bridge"
  }
}
```

---

## 💡 Future Ideas

* Multiple synthetic stream types
* SSE support instead of WebSocket
* Connect to real APIs (e.g. IoT sensor sim)
* Live editing of Flink SQL from the frontend
* Use Flink or Kafka later for distributed real-time ingestion

---

## 🧼 Cleanup

```bash
docker-compose down
```

---

## 🙌 Credits

* [Flowturi](https://github.com/ThatOrJohn/flowturi)
* Apache Flink
* ws (WebSocket lib for Node.js)
* npm-run-all

---

MIT License

